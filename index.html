<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rent Bill Generator</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
</head>
<body>

    <h2>Rent Bill Generator</h2>

    <div class="container">
        <input type="text" id="tenant_name" placeholder="Tenant Name" required>
        <select id="billing_month">
            <option value="" disabled selected>Select Billing Month</option>
            <option>January</option>
            <option>February</option>
            <option>March</option>
            <option>April</option>
            <option>May</option>
            <option>June</option>
            <option>July</option>
            <option>August</option>
            <option>September</option>
            <option>October</option>
            <option>November</option>
            <option>December</option>
        </select>

        <h3>Electricity</h3>
        <input type="number" id="elec_prev" placeholder="Previous Reading">
        <input type="number" id="elec_curr" placeholder="Current Reading">
        <input type="number" id="elec_unit_charge" placeholder="Unit Charge (₹)">

        <h3>Pump Charges</h3>
        <div>
            <input type="checkbox" id="include_pump" onclick="togglePumpFields()">
            <label for="include_pump">Include Pump Charges</label>
        </div>
        <div id="pump_fields" style="display: none;">
            <input type="number" id="pump_prev" placeholder="Previous Reading">
            <input type="number" id="pump_curr" placeholder="Current Reading">
            <input type="number" id="pump_unit_charge" placeholder="Unit Charge (₹)">
            <input type="number" id="num_people" placeholder="Number of People Sharing">
        </div>

        <h3>Rent & Adjustments</h3>
        <input type="number" id="rent_amount" placeholder="Rent (₹)">
        <input type="number" id="prev_due" placeholder="Previous Due (₹)">
        <input type="number" id="prev_advance" placeholder="Previous Advance (₹)">

        <h3>Additional Room (Optional)</h3>
        <div>
            <input type="checkbox" id="include_room" onclick="toggleRoomFields()">
            <label for="include_room">Include Additional Room Charges</label>
        </div>
        <div id="room_fields" style="display: none;">
            <input type="text" id="room_name" placeholder="Room Name (Optional)">
            <input type="number" id="room_prev" placeholder="Room Previous Reading">
            <input type="number" id="room_curr" placeholder="Room Current Reading">
            <input type="number" id="room_unit_charge" placeholder="Room Unit Charge (₹)">
        </div>

        <button onclick="generateBill()">Generate Bill</button>
        <button onclick="downloadPDF()">Download PDF</button>
    </div>

    <div id="bill" style="display: none;">
        <h3>Rent Bill Receipt</h3>
        <p><strong>Tenant:</strong> <span id="bill_tenant"></span></p>
        <p><strong>Month:</strong> <span id="bill_month"></span></p>

        <div id="calculation_details">
            <h4>Calculation Details</h4>
            <p><strong>Electricity:</strong> <span id="elec_calc"></span></p>
            <p id="pump_calc_section" style="display: none;"><strong>Pump:</strong> <span id="pump_calc"></span></p>
            <p id="room_calc_section" style="display: none;"><strong>Additional Room:</strong> <span id="room_calc"></span></p>
        </div>

        <h4>Bill Breakdown</h4>
        <table>
            <tr>
                <td>Unit Charges</td>
                <td id="unit_amount"></td>
            </tr>
            <tr>
                <td>Rent</td>
                <td id="rent_display"></td>
            </tr>
            <tr>
                <td>Previous Due</td>
                <td id="due_display"></td>
            </tr>
            <tr>
                <td>Previous Advance</td>
                <td id="advance_display"></td>
            </tr>
            <tr>
                <th>Total</th>
                <th id="total_amount"></th>
            </tr>
        </table>
    </div>

    <script>
        function togglePumpFields() {
            document.getElementById('pump_fields').style.display = 
                document.getElementById('include_pump').checked ? 'block' : 'none';
        }

        function toggleRoomFields() {
            document.getElementById('room_fields').style.display = 
                document.getElementById('include_room').checked ? 'block' : 'none';
        }

        function generateBill() {
            const tenantName = document.getElementById('tenant_name').value;
            const month = document.getElementById('billing_month').value;
            const elecPrev = parseFloat(document.getElementById('elec_prev').value) || 0;
            const elecCurr = parseFloat(document.getElementById('elec_curr').value) || 0;
            const elecUnitCharge = parseFloat(document.getElementById('elec_unit_charge').value) || 0;

            let unitCharges = (elecCurr - elecPrev) * elecUnitCharge;

            let pumpCharges = 0;
            if (document.getElementById('include_pump').checked) {
                const pumpPrev = parseFloat(document.getElementById('pump_prev').value) || 0;
                const pumpCurr = parseFloat(document.getElementById('pump_curr').value) || 0;
                const pumpUnitCharge = parseFloat(document.getElementById('pump_unit_charge').value) || 0;
                const numPeople = parseFloat(document.getElementById('num_people').value) || 1;
                pumpCharges = (pumpCurr - pumpPrev) * pumpUnitCharge / numPeople;
                document.getElementById('pump_calc_section').style.display = 'block';
                document.getElementById('pump_calc').textContent = `₹${pumpCharges.toFixed(2)}`;
            }

            let roomCharges = 0;
            if (document.getElementById('include_room').checked) {
                const roomPrev = parseFloat(document.getElementById('room_prev').value) || 0;
                const roomCurr = parseFloat(document.getElementById('room_curr').value) || 0;
                const roomUnitCharge = parseFloat(document.getElementById('room_unit_charge').value) || 0;
                roomCharges = (roomCurr - roomPrev) * roomUnitCharge;
                document.getElementById('room_calc_section').style.display = 'block';
                document.getElementById('room_calc').textContent = `₹${roomCharges.toFixed(2)}`;
            }

            const rentAmount = parseFloat(document.getElementById('rent_amount').value) || 0;
            const totalBill = unitCharges + pumpCharges + roomCharges + rentAmount;

            document.getElementById('bill_tenant').textContent = tenantName;
            document.getElementById('bill_month').textContent = month;
            document.getElementById('unit_amount').textContent = `₹${unitCharges.toFixed(2)}`;
            document.getElementById('rent_display').textContent = `₹${rentAmount.toFixed(2)}`;
            document.getElementById('total_amount').textContent = `₹${totalBill.toFixed(2)}`;
            document.getElementById('bill').style.display = 'block';
        }

        function downloadPDF() {
            html2pdf(document.getElementById('bill'));
        }
    </script>

</body>
</html>
