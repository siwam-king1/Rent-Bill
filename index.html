<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rent Bill Generator</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
</head>
<body>

    <h2>Rent Bill Generator</h2>

    <div class="container">
        <input type="text" id="tenant_name" placeholder="Tenant Name" required>
        <select id="billing_month">
            <option value="" disabled selected>Select Billing Month</option>
            <option>January</option>
            <option>February</option>
            <option>March</option>
            <option>April</option>
            <option>May</option>
            <option>June</option>
            <option>July</option>
            <option>August</option>
            <option>September</option>
            <option>October</option>
            <option>November</option>
            <option>December</option>
        </select>

        <h3>Electricity</h3>
        <input type="number" id="elec_prev" placeholder="Previous Reading">
        <input type="number" id="elec_curr" placeholder="Current Reading">
        <input type="number" id="elec_unit_charge" placeholder="Unit Charge (₹)">

        <h3>Pump Charges</h3>
        <div class="optional">
            <input type="checkbox" id="include_pump" onchange="togglePump()">
            <label for="include_pump">Include Pump Charges</label>
        </div>
        <input type="number" id="pump_prev" placeholder="Previous Reading" disabled>
        <input type="number" id="pump_curr" placeholder="Current Reading" disabled>
        <input type="number" id="pump_unit_charge" placeholder="Unit Charge (₹)" disabled>
        <input type="number" id="num_people" placeholder="Number of People Sharing" disabled>

        <h3>Rent & Adjustments</h3>
        <input type="number" id="rent_amount" placeholder="Rent (₹)">
        <input type="number" id="prev_due" placeholder="Previous Due (₹)" value="0">
        <input type="number" id="prev_advance" placeholder="Previous Advance (₹)" value="0">

        <h3>Additional Room (Optional)</h3>
        <div class="optional">
            <input type="checkbox" id="include_room" onchange="toggleRoom()">
            <label for="include_room">Include Additional Room Charges</label>
        </div>
        <input type="text" id="room_name" placeholder="Room Name (Optional)" disabled>
        <input type="number" id="room_prev" placeholder="Room Previous Reading" disabled>
        <input type="number" id="room_curr" placeholder="Room Current Reading" disabled>
        <input type="number" id="room_unit_charge" placeholder="Room Unit Charge (₹)" disabled>

        <button onclick="generateBill()">Generate Bill</button>
        <button onclick="downloadPDF()">Download PDF</button>
    </div>

    <div id="bill" class="bill-container">
        <div class="bill-header">
            <h3>Rent Bill Receipt</h3>
            <p><strong>Tenant:</strong> <span id="bill_tenant"></span></p>
            <p><strong>Month:</strong> <span id="bill_month"></span></p>
        </div>

        <h3>Calculation Details</h3>
        <p><strong>Electricity Calculation:</strong> <span id="elec_calc"></span></p>
        <p id="pump_section" style="display:none;"><strong>Pump Calculation:</strong> <span id="pump_calc"></span></p>
        <p id="room_section" style="display:none;"><strong>Additional Room Calculation:</strong> <span id="room_calc"></span></p>

        <h3>Bill Breakdown</h3>
        <table>
            <tr>
                <th>Description</th>
                <th>Amount (₹)</th>
            </tr>
            <tr>
                <td>Unit Charges</td>
                <td id="unit_amount"></td>
            </tr>
            <tr>
                <td>Rent</td>
                <td id="rent_display"></td>
            </tr>
            <tr>
                <td>Previous Due</td>
                <td id="due_display"></td>
            </tr>
            <tr>
                <td>Previous Advance</td>
                <td id="advance_display"></td>
            </tr>
            <tr class="total">
                <td>Total</td>
                <td id="total_amount"></td>
            </tr>
        </table>
    </div>

    <script>
        // Enable/Disable Pump Fields
        function togglePump() {
            let isChecked = document.getElementById('include_pump').checked;
            document.getElementById('pump_prev').disabled = !isChecked;
            document.getElementById('pump_curr').disabled = !isChecked;
            document.getElementById('pump_unit_charge').disabled = !isChecked;
            document.getElementById('num_people').disabled = !isChecked;
        }

        // Enable/Disable Room Fields
        function toggleRoom() {
            let isChecked = document.getElementById('include_room').checked;
            document.getElementById('room_name').disabled = !isChecked;
            document.getElementById('room_prev').disabled = !isChecked;
            document.getElementById('room_curr').disabled = !isChecked;
            document.getElementById('room_unit_charge').disabled = !isChecked;
        }

        // Generate Bill
        function generateBill() {
            let tenantName = document.getElementById('tenant_name').value;
            let month = document.getElementById('billing_month').value;

            let elecPrev = parseFloat(document.getElementById('elec_prev').value);
            let elecCurr = parseFloat(document.getElementById('elec_curr').value);
            let elecUnitCharge = parseFloat(document.getElementById('elec_unit_charge').value);
            let unitCharges = (elecCurr - elecPrev) * elecUnitCharge;

            let pumpCharges = 0, roomCharges = 0;

            if (document.getElementById('include_pump').checked) {
                let pumpPrev = parseFloat(document.getElementById('pump_prev').value);
                let pumpCurr = parseFloat(document.getElementById('pump_curr').value);
                let pumpUnitCharge = parseFloat(document.getElementById('pump_unit_charge').value);
                let numPeople = parseFloat(document.getElementById('num_people').value);
                pumpCharges = (pumpCurr - pumpPrev) * pumpUnitCharge / numPeople;
                document.getElementById('pump_section').style.display = 'block';
                document.getElementById('pump_calc').textContent = `(${pumpCurr} - ${pumpPrev}) × ${pumpUnitCharge} ÷ ${numPeople} = ₹${pumpCharges.toFixed(2)}`;
            } else {
                document.getElementById('pump_section').style.display = 'none';
            }

            if (document.getElementById('include_room').checked) {
                let roomPrev = parseFloat(document.getElementById('room_prev').value);
                let roomCurr = parseFloat(document.getElementById('room_curr').value);
                let roomUnitCharge = parseFloat(document.getElementById('room_unit_charge').value);
                roomCharges = (roomCurr - roomPrev) * roomUnitCharge;
                document.getElementById('room_section').style.display = 'block';
            }

            let totalBill = unitCharges + pumpCharges + roomCharges;

            document.getElementById('total_amount').textContent = `₹${totalBill.toFixed(2)}`;
        }

        function downloadPDF() {
            html2pdf(document.getElementById('bill'));
        }
    </script>
</body>
</html>
